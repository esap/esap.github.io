---
layout: post
title:  "ESAP第八弹 导航的艺术"
categories: esap中级
tags:  勤哲 excelserver ERP 导航 ESAP VBA
---

* content
{:toc}

## 概述
两年前，笔者为一个由400多个ES模板构建的ERP系统专门设计了一套导航模板。该套系统案例在官方展示后引起很大震动。

近期，笔者给月饼库也打造了一套简单实用的系统导航。

在这一篇中，将展示其中的关键技术。 

## 概览

* 导航模板依照通用界面设计，即：上方功能区，侧方分组区和中部内容显示区。

![](/img/esap8-1.jpg)

--ES导航-待办事宜--

![](/img/esap8-2.jpg)

--ES导航-流程图--

## 待办事宜

* 为获取待办事宜，需要定义一个待办视图：

![](/img/esap8-3.jpg)

* 这样就能在导航中用表间公式显示用户的待办事宜列表。

![](/img/esap8-4.jpg)

* 如果是9.4版本，可以直接选中办理这些事宜。

![](/img/esap8-5.jpg)

![](/img/esap8-6.jpg)

## 流程图

* 在画好的流程图上指定宏，调用VBA接口，便可打开相应的模板。

![](/img/esap8-7.jpg)

* 通用宏定义：

![](/img/esap8-8.jpg)

* 设计时将`图片名改`为`模板名称`即可调用相应模板，十分巧妙。

![](/img/esap8-9.jpg)

## 模板搜索

* 模板数量太多时，可以通过模板搜索快速找到和打开相应模板（选择后回车）。

![](/img/esap8-10.jpg)

![](/img/esap8-11.jpg)

* 模板搜索存储过程：

![](/img/esap8-12.jpg)

* 模板搜索VBA调用过程：

![](/img/esap8-13.jpg) 

## 应用技巧

* 如果你对示例图中那些小标签非常感兴趣，可以安装一款叫OfficeTab的插件，这款插件只有几兆大小，可以让你的word,excel等office组件都拥有标签功能，能够像网页一样进行操作，十分方便。

* 最重要的是，它能让ES导航更加方便快捷。 

## 小结

对于ES系统而言，导航模板并不是必须的，但导航模板设计得当，完全可以取代古板的工作台。

最后，仍然是那句话：`思想有多远，我们就能走多远`。 