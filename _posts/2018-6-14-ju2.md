---
layout: post
title:  "使用聚表/慧表打造在线考试系统(附库)"
categories: 日志
tags:  ju 聚表 慧表 esap 考试系统 题库 随机抽题
---

* content
{:toc}

本文记录了村长用聚表/慧表捣鼓考试系统的心得，希望能启发您做出更多好玩的系统。

## 题库模板
首先做个题库，包含单选，多选，判断题

* 题库表主要字段是`题目`，`选项`，`答案`和`图片`，如下图：

![](/img/ju2-1.jpg)

## 考试模板
考试模板主要有`已答题计数`，题库相关字段，已选择的`答案`，如下图

![](/img/ju2-2.jpg)

看着很丑，没关系，我们接下来要讲重点了。

#### 随机抽题
在传统ES中这是一个难点，一般是通过EXCEL函数或者vba去生成不重复随机数，然后匹配抽题。

* 在聚表中，这反而成了最简单的问题，设置一个新建表单时执行的提数公式，直接从题库提取10个题，然后手工在sql后加上`order by newid()`即可。

![](/img/ju2-3.jpg)

* 抽题存入sheet2，id这一列就是题目的真实数据库id，可以看到已经随机排列，每次新建都不同。

![](/img/ju2-4.jpg)

#### 下一题
![](/img/ju2-5.jpg)

上面是`下一题`按钮的命令，主要包含三个部分：

* 1.将作答存入sheet2的回答字段，用来匹配记分。

* 2.当还有下一题(共10题)时，`已答`数增1，提取题目，否则保存退出。

* 3.根据题目类型，设置相关答题按钮状态，例如判断题时只显示`对错`按钮，否则显示`ABCD`按钮。

#### 答题
答题按钮分`对错`和`ABCD`两组共6个，另外加一个`重置按钮`，命令都是给主表`答案`字段赋值。

![](/img/ju2-6.jpg)

## 最终效果演示
![](/img/ju2-7.gif)

## 小结
* 使用聚表/慧表，可以轻松实现随机获取记录。

* 本文涉及的案例已打包成[【六一库(180614)】←点击下载](/files/61data180614.zip)，欢迎下载玩耍。