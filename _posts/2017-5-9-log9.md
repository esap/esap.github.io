---
layout: post
title:  "ESAP2.7正式版发布"
categories: 日志
tags:  golang esap服务器 分布式  微信企业号 excelserver destiny
---

* content
{:toc}

<p align="center">
  <img src="/img/logo.jpg" width="120">
</p>

## 历程回顾
继年初v2.0版发布后，经过两月的时间，迭代到v2.5。

v2.5到2.7版又花费了两个月开发和稳定，这其中发生了什么巨变？!

本次发行代号为：destiny（命运），先看看更新日志吧^_^

** [官方主页](https://esap.erp8.net) **

## 更新日志

发布于2017-5-9

* [新增]新增WxqdTitle配置项，用于配置微信签到显示标题。
* [新增]新增upload接口，用于上传图片文件。
* [新增]微信查询新增P参数，表示输入的所有内容。
* [新增]新增计划任务模块(全新的玩法，更多的脑洞)；玩家需求!
* [新增]微信查询新增多重返回，可以一次写多个select，保证返回的字段数量一致即可；
* [新增]新增若干开关，可手工更改EsConf配置文件进行调整；
* [新增]微信查询新增默认应用支持(全新的玩法，更多的脑洞)；玩家需求!
* [新增]新增log模块，运行日志写入esap.log文件，上次日志存入日志备份(esap.log.bak)，当配置Debug=false时，将不再打印sql模板相关信息，可大幅减小日志文件体积；
* [新增]微信提醒增加重发机制(配置文件ReTryMsg=true)，海外用户应用时更稳定；玩家需求!
* [新增]微信提醒“部门/职位”格式的接收人支持；玩家需求!
* [调整]微信提醒接收人填报更自由，可使用姓名，账号，手机号，微信号，邮箱，职位，部门任意组合搭配；
* [新增]支持保密消息(safe=1)；玩家需求!
* [新增]ESWEB待办事宜列表打开；
* [新增]超级查询新增用户进入时显示可用查询列表(配置ShowFuncListEnter=true)，企业号端需开启上报用户进入，此外配置文件ShowFuncList=true时，查询中未匹配任何功能也会返回可用查询列表；
* [新增]超级查询新增ES表单搜索查看功能；
* [新增]超级查询增加打包回复模式，解决消息内容过多时的乱序问题（mediaOnly=3）；
* [新增]HOST配置支持端口，可以与监听端口(例如9090)不一致，更方便外网NAT；
* [新增]微信权限支持自定义角色权限支持；
* [新增]esmail自定义发件人支持,可不使用系统Email账户,但与系统Email共用smtp服务器设置；玩家需求!
* [调整]调整微信提醒，邮件提醒，使用计划任务进行配置；
* [调整]调整微信反馈，增加附件上传与回复；
* [调整]超级查询优化消息机制，改善网络延迟造成的重发问题；
* [调整]采用vux重写app；
* [调整]采用sqlt重写esmail插件、微信提醒插件、超级查询和api模块等，支持自定义sql模板；
* [调整]取消微信通讯录模板，改为服务器缓存，解决重名和同步等烦恼；
* [调整]重构ESAP主容器，采用模块化+插件化架构，适应大规模开发定制应用；
* [修复]中文消息超过500字时拆分出空消息的bug；

## 小结
* 2.7版采纳了大量社区的金点子，同时又整合了大量开源社区力量，发行代号为destiny,即“命运”由您决定！

* 2.7版相比2.5版最大的变化来自于程序本身的组织架构，如果说2.5是实现了功能，那么2.7就是强化优化了功能，这其中有架构层面也有功能层面。

* 2.7版引入了golang社区的一些新的库，例如sqlt，task，log，也引入了vux这样的前端库，引入库不是目的，目的是使所有功能变得可控，可拆分，可扩展，可配置。

* 2.7版可配置的内容和功能实在太丰富，计划任务和默认查询的发挥余地有待社区大大力挖掘，sql模板也给前端开发以及移植ESAP带来了极大便利，相关文档将在后续发布，敬请期待。

* by @村长

* 2017-5-9

