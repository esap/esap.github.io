---
layout: post
title:  "ESAP中级教程|快速打造MES在线移动APP报工"
categories: ESAP中级教程
tags:  ESAP 慧表 nxapp nx MES 报工 APP
---

* content
{:toc}

## 客户需求

> @长亭红日：我们已经有ERP系统了，想做移动APP应用，直接利用已有系统数据。

## 模拟场景

假设用户目前使用的的是ES，系统里面有生产订单：

![](/img/esap11a-1.png)

然后员工在产线上使用pdf直接对订单扫码报工：

![](/img/esap11a-2.png)

在产订单信息自动汇总更新：

![](/img/esap11a-3.png)

## 解决方案

ES124没有app，我们可以引入nxapp来解决这个问题，主要通过外部数据源的方式实现数据互通，整个过程中，ES负责计划员下抛订单部分，NX负责员工产线上报部分，从而实现MES闭环系统。

## 实现步骤

#### 1.部署NX

安装NX，并建立一个nxapp账套，数据库最好与ES一起，这样注册外部源更容易。

![](/img/esap11a-4.png)

安装nxbs，完成app服务器部署，默认使用88端口。

![](/img/esap11a-5.png)

#### 2.NX上注册ES库

点击设计区-数据-外部数据源，注册es库，注册订单主表和明细：

![](/img/esap11a-6.png)

创建报工单模板，定义好相关字段，勾选手机填报，`订单号`设置为二维码，便于扫码识别。

![](/img/esap11a-7.png)

定义提数，根据`订单号`从es订单主表和明细提数产品明细以便报工产量。

![](/img/esap11a-8.png)

在nx/web/img/mobile目录下放个报工单图片做图标。

![](/img/esap11a-9.png)

将报工单发布手机端即可。

![](/img/esap11a-10.png)

#### 3.ES上注册NX库

在ES管理控制台注册nxapp外部数据源，注册报工单主表明细。

![](/img/esap11a-11.png)

在ES生产订单模板上设置提数，从nxapp报工单主表明细提取合计报工数填入`已完工`字段。

![](/img/esap11a-12.png)

## 最终实际效果

员工直接通过app在线报工：

![](/img/esap11a-13.gif)

ES获得产量反馈：

![](/img/esap11a-14.png)

## 小结

* 使用nxapp来在线作业，硬件部分可以是手机，pda，pad，大屏幕等无线设备。

* 通过外部数据源实现数据对接互访。

* 此方案拓展后可快速转化任意ERP系统为MES级系统，例如金蝶，用友，SAP等。

2019-10-22