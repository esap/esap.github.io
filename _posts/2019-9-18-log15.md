---
layout: post
title:  "ESAP中级教程|打印记录和打印控制"
categories: ESAP中级教程
tags:  ESAP nx 打印 打印记录
---

* content
{:toc}

## 客户需求

打印功能有特殊的要求，要记录打印次数，打印人，打印时间，第一次打印显示原件，其他打印显示复印件。

## 实现栗子

以nxt库的【发票识别】模板为例，实现客户的需求。

![](/img/log15-1.png)

首先设置一下打印区域

![](/img/log15-2.png)

定义两个字段，打印次数，打印人

![](/img/log15-3.png)

模板右下角弄个EXCEL工时，当打印次数>0显示`复印件`，否则显示`原件`

![](/img/log15-6.png)

建个按钮，执行赋值+回写，并且打印sheet1

![](/img/log15-4.png)

设置模板属性，关闭自带打印菜单，使用户只能用我们的自定义按钮打印

![](/img/log15-5.png)

## 最终效果

找个表单打开，只有一个自定义打印按钮，右下显示原件。

![](/img/log15-7.png)

点两次打印后，右下角编程复印件，同时也完成了计数。

![](/img/log15-8.png)

## 小结

* 使用自定义按钮代替原有打印按钮。

* 使用报表命令记录次数和人员。

> 村长：勿忘国耻，最近忙于项目，博客更新不太勤快，但会抽空发一些小技巧

2019-09-18