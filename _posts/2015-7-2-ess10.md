---
layout: post
title:  "ES构造日期明细"
categories: es秘籍
tags:  勤哲 excelserver 生成日期
---

* content
{:toc}

最近有群友问起该问题，特发此文。

## 需求分析
用户填入年份或月份，自动生成该年所有的日期明细或该月所有的日期明细。
 
![](/img/ess10-1.jpg)

## 实现步骤
* 建立辅助表，填充1~366
 
![](/img/ess10-2.jpg)
 
#### 【重点】建立填报模板，设置表间公式如下： 
* 构造全年明细
 
![](/img/ess10-3.jpg)

* 构造全月明细
 
![](/img/ess10-4.jpg)

说明：这里主要应用了间隔时间来和辅助表来筛选需要产生的行数，用日期加减完成日期的完整填充。

![](/img/ess10-5.jpg)

> 村长补记：本文技术可以变通一下用来构造任意时间段的所有日期明细！